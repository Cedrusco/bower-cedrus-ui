/*!
 * Cedrus UI
 * https://github.com/cedrusco/cedrus-ui
 * @license Copyright Cedrus 2015-2016
 * v0.2.0
 */
!function(t,e,n){"use strict";!function(){e.module("cedrus.ui",["ngMaterial","ngAnimate","cedrus.ui.core","cedrus.ui.components.cdBarChart","cedrus.ui.components.calendar","cedrus.ui.components.cdChart","cedrus.ui.components.cdGroupedBarChart","cedrus.ui.components.cdLineChart","cedrus.ui.components.linechart","cedrus.ui.components.cdPieChart"])}(),function(){var t;!function(t){e.module("cedrus.ui.core",["ngMaterial"])}(t||(t={}))}(),function(){var t;!function(t){function n(t,e,n){e.setDefaultDateFormat("MM/dd/yyyy")}n.$inject=["$provide","$cedrusUIConfigProvider","$mdThemingProvider"],e.module("cedrus.ui.core").config(n)}(t||(t={}))}(),function(){var t;!function(t){function n(t,e){function n(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()}var i=e?/([^\W_]+[^\s-]*) */g:/([^\W_]+[^\s-]*)/;return t?t.replace(i,n):""}e.module("cedrus.ui.core").filter("capitalize",function(){return n})}(t||(t={}))}(),function(){var t;!function(t){var n=function(){function t(){this.CSS={SAMPLE:"1"}}return t}();e.module("cedrus.ui.core").factory("$cedrusConstant",function(){return new n})}(t||(t={}))}(),function(){var t;!function(t){function n(t,e){var n=t.replace(/([a-z])([A-Z])/g,"$1 $2");return n}e.module("cedrus.ui.core").filter("normalizeCamelCase",function(){return n})}(t||(t={}))}(),function(){var t;!function(t){var n=function(){function t(){this._UI_DEFAULT_DATE_FORMAT="MM/dd/yyyy",this.dateFormat=this._UI_DEFAULT_DATE_FORMAT}return t.prototype.$get=function(){return{getDateFormat:this.getDefaultDateFormat}},t.prototype.setDefaultDateFormat=function(t){this.dateFormat=t||this._UI_DEFAULT_DATE_FORMAT},t.prototype.getDefaultDateFormat=function(){return this.dateFormat||this._UI_DEFAULT_DATE_FORMAT},t}();t.UIConfigProvider=n,e.module("cedrus.ui.core").provider("$cedrusUIConfig",n)}(t||(t={}))}(),function(){var n;!function(n){var i=function(){function n(){this.isDebug=!0,this.now=t.performance?e.bind(t.performance,t.performance.now):Date.now||function(){return(new Date).getTime()}}return n.prototype.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];t.isDebug&&console.debug.apply(console,["Cedrus UI:"].concat(e))},n.prototype.time=function(t){var e=this.now();return t(),this.now()-e},n}();e.module("cedrus.ui.core").factory("$cedrusUtil",function(){return i})}(n||(n={}))}(),function(){var t;!function(t){var n=function(){function t(){this.bindings={data:"<",options:"<"},this.templateUrl="components/bar-chart/bar-chart.tpl.html",this.controller="BarChartController",this.controllerAs="vm"}return t}();e.module("cedrus.ui.components.cdBarChart",[]).component("cdBarChart",new n)}(t||(t={}))}(),function(){var t;!function(t){var n=function(){function t(){this.data=[],this.options={},this.margin={top:30,right:30,bottom:40,left:80},this.height=400-this.margin.top-this.margin.bottom,this.width=600-this.margin.left-this.margin.right,this.barWidth=50,this.barOffset=5}return t.prototype.Draw=function(t){var e=this;if(this.svg&&t.length){var n=d3.scaleLinear().domain([0,d3.max(t,function(t){return t[e.yAxisOption]})]).range([0,this.height]),i=d3.scaleBand().domain(t.map(function(t){return t[e.xAxisOption]})).rangeRound([0,this.width]).paddingInner(.05).paddingOuter(.05),o=(d3.scaleLinear().domain([0,d3.max(t,function(t){return t[e.yAxisOption]})]).range(["#FFB832","#C61C6F"]),d3.scaleLinear().domain([0,t.length]).range(["#FFB832","#C61C6F"])),r=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t){return"<strong>"+e.yAxisOption+":</strong> <span> "+t[e.yAxisOption]+" </span>"});this.svg.call(r);var a=this.svg.selectAll("rect").data(t);a.enter().append("rect").merge(a).style("fill",function(t,e){return o(e)}).attr("width",function(t){return i.bandwidth()}).attr("height",0).attr("x",function(t){return i(t[e.xAxisOption])}).attr("y",this.height).on("mouseover",r.show).on("mouseout",r.hide).transition().attr("height",function(t){return n(t[e.yAxisOption])}).attr("y",function(t){return e.height-n(t[e.yAxisOption])}).delay(function(t,e){return 20*e}).duration(1e3);var s=d3.scaleLinear().domain([0,d3.max(this.data,function(t){return t[e.yAxisOption]})]).range([this.height,0]),l=d3.axisLeft(s).ticks(10);l(this.vGuide),this.vGuide.attr("transform","translate("+this.margin.left+","+this.margin.top+")");var c=d3.axisBottom(i);c(this.hGuide),this.hGuide.attr("transform","translate("+this.margin.left+","+(this.height+this.margin.top)+")"),a.exit().remove()}},t.prototype.$onInit=function(){this.xAxisOption=this.options.xaxis,this.yAxisOption=this.options.yaxis,this.svg=d3.select("#chart").attr("width",this.width+this.margin.left+this.margin.right).attr("height",this.height+this.margin.top+this.margin.bottom).append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.hGuide=d3.select("#chart").append("g"),this.vGuide=d3.select("#chart").append("g"),this.Draw(this.data)},t.prototype.$onChanges=function(t){this.xAxisOption=this.options.xaxis,this.yAxisOption=this.options.yaxis,this.Draw(this.data)},t}();e.module("cedrus.ui.components.cdBarChart").controller("BarChartController",n)}(t||(t={}))}(),function(){var t;!function(t){var n=function(){function t(){this.templateUrl="components/calendar/calendar.tpl.html",this.controllerAs="vm",this.controller="CalendarController",this.bindings={options:"="},this.require={ngModel:"ngModel"}}return t}();e.module("cedrus.ui.components.calendar",[]).component("cdCalendar",new n)}(t||(t={}))}(),function(){var t;!function(t){var n=function(){function t(t){this.$element=t,this.yearMap=[[-4,-3,-2],[-1,0,1],[2,3,4],[5,6,7]],this.monthMap=[[{display:"Jan",value:"January"},{display:"Feb",value:"February"},{display:"Mar",value:"March"}],[{display:"Apr",value:"April"},{display:"May",value:"May"},{display:"Jun",value:"June"}],[{display:"Jul",value:"July"},{display:"Aug",value:"August"},{display:"Sep",value:"September"}],[{display:"Oct",value:"October"},{display:"Nov",value:"November"},{display:"Dec",value:"December"}]]}return t.prototype.$onInit=function(){this.initYear=(new Date).getFullYear(),this.date={selYear:this.initYear,selMonth:""},this.showCal=!1},t.prototype.$postLink=function(){this.inputEl=this.$element.find("input"),this.options&&this.options.blockFreeTyping===!0&&this.inputEl.keydown(function(t){t.preventDefault()})},t.prototype.displayCal=function(){this.showCal=!this.showCal,this.showCal&&this.inputEl.focus()},t.prototype.flipCal=function(){this.yearSel=!this.yearSel},t.prototype.setYear=function(t){this.date.selYear||(this.date.selYear=this.initYear),this.date.selYear+=t},t.prototype.setMonth=function(t){this.date.selYear||(this.date.selYear=this.initYear),this.date.selMonth=t,this.ngModel.$setViewValue(this.date.selMonth+" "+this.date.selYear),this.ngModel.$render(),this.selection=this.ngModel.$viewValue,this.showCal=!1},t.$inject=["$element"],t}();e.module("cedrus.ui.components.calendar").controller("CalendarController",n)}(t||(t={}))}(),function(){var t;!function(t){var n=function(){function t(){this.bindings={data:"=",options:"="},this.template="<svg></svg>",this.controller="CdChartController",this.controllerAs="vm"}return t}();e.module("cedrus.ui.components.cdChart",[]).component("cdChart",new n)}(t||(t={}))}(),function(){var t;!function(t){var n=function(){function t(t,n){this.$element=t,this.$injector=n,this.defaultOptions={width:360,height:360},this.options=e.merge(this,this.options,this.defaultOptions),this.width=this.options.width,this.height=this.options.height,this.svg=d3.select(this.$element[0]).select("svg").attr("width",this.width).attr("height",this.height),this.chartService=this.$injector.get(this.options.chartType+"Service"),console.log(this.chartService,this.data)}return t.prototype.$onInit=function(){this.drawChart()},t.prototype.$onChanges=function(t){this.drawChart()},t.prototype.drawChart=function(){this.data.length&&this.chartService.draw(this.svg,this.data,this.options)},t.$inject=["$element","$injector"],t}();e.module("cedrus.ui.components.cdChart").controller("CdChartController",n)}(t||(t={}))}(),function(){var t;!function(t){var n=function(){function t(){this.bindings={data:"=",options:"="},this.templateUrl="components/grouped-bar-chart/grouped-bar-chart.tpl.html",this.controller="groupedBarChartController",this.controllerAs="vm",this.transclude=!0}return t}();e.module("cedrus.ui.components.cdGroupedBarChart",[]).component("cdGroupedBarChart",new n)}(t||(t={}))}(),function(){var t;!function(t){var n=function(){function t(){this.groupDataKeys=[],this.groupData={},this.totalKeys=0,this.expandedField=[],this.groups={},this.groupKeys=[],this.dataLength=this.data.length}return t.prototype.$onInit=function(){this.options.colors&&this.options.colors.list?this.colors=this.options.colors.list:this.colors=["red","blue","lightblue","grey","black"],this.generateGroups()},t.prototype.getColor=function(t,e){return e=e.toLowerCase(),this.options.colors&&this.options.colors.bindings&&this.options.colors.bindings[e]?this.options.colors.bindings[e]:this.colors[t%this.colors.length]},t.prototype.expandField=function(t){return this.expandedField.indexOf(t)!==-1},t.prototype.setExpandedField=function(t,e){e?this.expandedField.splice(this.expandedField.indexOf(t),1):this.expandedField.push(t)},t.prototype.generateGroups=function(){this.data.forEach(function(t,e){if(t[this.options.groupingField]){var n;n=this.options.transform?this.options.transform(t):t[this.options.groupingField],this.groups[n]||(this.groups[n]=[]),this.groups[n].push(t),this.totalKeys++}}.bind(this)),this.groupKeys=Object.keys(this.groups),e.copy(this.groupKeys,this.groupDataKeys),e.copy(this.groups,this.groupData)},t.prototype.showData=function(){return this.data.length!==this.dataLength&&this.generateGroups(),this.dataLength=this.data.length,0!==this.data.length},t}();e.module("cedrus.ui.components.cdGroupedBarChart").controller("groupedBarChartController",n)}(t||(t={}))}(),function(){var t;!function(t){var n=function(){function t(){this.template="<svg></svg>",this.controller="cdLineChartController",this.controllerAs="this",this.bindings={data:"<",options:"<"}}return t}();e.module("cedrus.ui.components.cdLineChart",[]).component("cdLineChart",new n)}(t||(t={}))}(),function(){var t;!function(t){var n=function(){function t(t){this.$element=t,this.padding=20,this.getDate=function(t){return new Date(t)}}return t.prototype.$onInit=function(){this.width=this.options.width||500,this.height=this.options.height||300,this.graph=d3.select(this.$element[0]).select("svg").attr("width",this.width).attr("height",this.height),this.path=this.graph.append("path").attr("class","line"),this.circles=this.graph.append("g").attr("class","circles"),this.xAxis=this.graph.append("g").attr("transform","translate(0,"+(this.height-this.padding)+")").attr("class","xAxis"),this.yAxis=this.graph.append("g").attr("class","yAxis").attr("transform","translate("+(this.padding+20)+", 0)"),this.data.length&&this.updateGraph(this.data)},t.prototype.$onChanges=function(t){t.data.currentValue.length&&this.updateGraph(t.data.currentValue)},t.prototype.updateGraph=function(t){var e=this,n=this.options.xAxis||(this.data[0]?Object.keys(this.data[0])[0]:""),i=this.options.yAxis||(this.data[0]?Object.keys(this.data[0])[1]:""),o=this.getDate(t[0][n]),r=this.getDate(t[t.length-1][n]),a=d3.scaleLinear().domain([o,r]).range([this.padding+20,this.width-this.padding]),s=d3.scaleLinear().domain([0,d3.max(t,function(t){return parseInt(t[i])})]).range([this.height-this.padding,10]),l=d3.line().x(function(t){return a(e.getDate(t[n]))}).y(function(t){return s(t[i])}).curve(d3.curveLinear),c=d3.axisBottom().scale(a).tickFormat(d3.timeFormat("%Y")),h=d3.axisLeft().scale(s).ticks(5);this.graph.selectAll(".line").transition().attr("d",l(t)).attr("stroke","purple").attr("fill","none");var d=this.graph.select(".circles").selectAll("circle").data(t,function(t){return t});d.enter().append("circle").merge(d).attr("cx",function(t,i){return a(e.getDate(t[n]))}).attr("cy",function(t){return s(t[i])}).attr("fill","purple").attr("stroke","purple").attr("r",3.5),d.exit().remove(),this.graph.select(".xAxis").call(c),this.graph.select(".yAxis").call(h)},t.$inject=["$element"],t}();e.module("cedrus.ui.components.cdLineChart").controller("cdLineChartController",n)}(t||(t={}))}(),function(){!function(){function t(){var t={bindings:{data:"=",options:"="},templateUrl:"components/line-chart/line.chart.tpl.html",controller:"LineChartController",controllerAs:"vm",transclude:!0};return t}e.module("cedrus.ui.components.linechart",[]).component("lineChart",t())}()}(),function(){var t;!function(t){var n=function(){function t(){this.template="<svg></svg><style>.legend { font-size: 10px; } rect.disabled {display:none !important;}</style>",this.controller="cdPieChartController",this.controllerAs="vm",this.bindings={data:"<",options:"<"}}return t}();e.module("cedrus.ui.components.cdPieChart",[]).component("cdPieChart",new n)}(t||(t={}))}(),function(){var t;!function(t){var n=function(){function t(t){var e=this;this.$element=t,this.countProp=this.options.countProp||"count",this.labelProp=this.options.labelProp||"label",this.width=360,this.height=360,this.radius=Math.min(this.width,this.height)/2,this.donutWidth=75,this.legendRectSize=18,this.legendSpacing=4,this.color=d3.scaleOrdinal(d3.schemeCategory20),this.svg=d3.select(this.$element[0]).select("svg").attr("width",this.width).attr("height",this.height).append("g").attr("transform","translate("+this.width/2+","+this.height/2+")"),this.arc=d3.arc().innerRadius(this.radius-this.donutWidth).outerRadius(this.radius),this.pie=d3.pie().value(function(t){return t[e.countProp]}).sort(function(t,n){return n[e.countProp]-t[e.countProp]})}return t.prototype.$onInit=function(){this.data.length&&this.drawGraph(this.data)},t.prototype.$onChanges=function(t){var e=this;t.data.currentValue.length&&(this.data.forEach(function(t){t[e.countProp]=+t[e.countProp],t.enabled=!0}),this.drawGraph(this.data))},t.prototype.myClickFun=function(t,e,n){this.options.clickFun(t,e,n)},t.prototype.drawGraph=function(t){var e=this;t=t.sort(function(t,n){return n[e.countProp]-t[e.countProp]});var n=this.arc,i=this.svg.selectAll("path").data(this.pie(t));i.exit().remove(),i=i.enter().append("path").merge(i).attr("fill",function(t,n){return e.color(t.data[e.labelProp])}),this.options.clickFun&&i.on("click",function(t,n,i){e.myClickFun(t,n,i)}),i.transition().duration(750).attrTween("d",function(t){var e=d3.interpolate(this._current,t);return this._current=e(0),function(t){return n(e(t))}});var o=this.svg.selectAll("g.legend").data(t);o.exit().remove();var r=o.enter().append("g").attr("class","legend");r.append("rect"),r.append("text");var a=r.merge(o);a.attr("transform",function(n,i){var o=e.legendRectSize+e.legendSpacing,r=o*t.length/2,a=-2*e.legendRectSize,s=i*o-r;return"translate("+a+","+s+")"}),a.select("text").attr("x",this.legendRectSize+this.legendSpacing).attr("y",this.legendRectSize-this.legendSpacing).text(function(t){return t[e.labelProp]}),a.select("rect").attr("width",this.legendRectSize).attr("height",this.legendRectSize).style("fill",function(t){return e.color(t[e.labelProp])}).style("stroke",function(t){return e.color(t[e.labelProp])})},t.$inject=["$element"],t}();e.module("cedrus.ui.components.cdPieChart").controller("cdPieChartController",n)}(t||(t={}))}(),function(){e.module("cedrus.ui").run(["$templateCache",function(t){t.put("components/calendar/calendar.tpl.html",'<div class="container"><div class="hider" ng-click="vm.displayCal()" ng-show="vm.showCal"></div><div class="input-blocker" ng-click="vm.displayCal()" readonly="true"></div><input type="text" class="md-select" ng-model="vm.selection"><div ng-show="vm.showCal" class="panel"><div class="md-whiteframe-2dp"><div class="yearrow" layout="row" layout-align="space-between end"><md-button class="calbtn" ng-click="vm.setYear(-1)" ng-hide="vm.yearSel" aria-label="previous year"><i class="fa fa-chevron-left"></i></md-button><md-button class="calbtn" ng-click="vm.setYear(-12)" ng-show="vm.yearSel" aria-label="go back one page"><i class="fa fa-chevron-left"></i></md-button><md-button class="calbtn yearbtn" ng-click="vm.flipCal()" aria-label="swap between month and year select">{{vm.date.selYear || vm.initYear}}</md-button><md-button class="calbtn" ng-click="vm.setYear(1)" ng-hide="vm.yearSel" aria-label="next year"><i class="fa fa-chevron-right"></i></md-button><md-button class="calbtn" ng-click="vm.setYear(12)" ng-show="vm.yearSel" aria-label="go forward by one page"><i class="fa fa-chevron-right"></i></md-button></div><div layout="row" ng-repeat="monthRow in vm.monthMap" ng-hide="vm.yearSel"><md-button class="calbtn monthSelect" ng-repeat="month in monthRow" ng-click="vm.setMonth(month.value)" aria-label="choose {{month.value}}">{{month.display}}</md-button></div><div layout="row" ng-repeat="yearRow in vm.yearMap" ng-show="vm.yearSel"><md-button class="calbtn yearSelect" ng-repeat="year in yearRow" ng-click="vm.flipCal(); vm.setYear(year)" aria-label="choose {{year}}">{{(vm.date.selYear||vm.initYear)+year}}</md-button></div></div></div></div>'),t.put("components/bar-chart/bar-chart.tpl.html",'<div id="container"><svg id="chart"></svg><div></div></div>'),t.put("components/grouped-bar-chart/grouped-bar-chart.tpl.html",'<div class="cd-grouped-bar-chart"><div ng-hide="vm.showData()"><div layout="row" layout-fill layout-align="center center" class="no-data"><span>There are no active tasks.</span></div></div><div ng-show="vm.showData()"><div ng-repeat="group in vm.groupDataKeys"><div layout="row" class="group-item"><div layout="column"><md-icon ng-hide="vm.expandField(group)" md-font-icon="fa fa-caret-right" ng-click="vm.setExpandedField(group)" ng-if="vm.options.subFields"></md-icon><md-icon ng-show="vm.expandField(group)" md-font-icon="fa fa-caret-down" ng-click="vm.setExpandedField(group, true)" ng-if="vm.options.subFields"></md-icon></div><div layout="column" flex><div layout="row" layout-align="space-around none"><div flex="60" layout-align="start center">{{group}}</div><div flex="20">Count: {{vm.groupData[group].length}}</div><div flex="20">{{vm.groupData[group].length*100/vm.totalKeys | number:0}}%</div></div></div></div><div layout="row" flex class="line-color"><div ng-style="{width:vm.groupData[group].length*100/vm.totalKeys + \'%\', \'background\': vm.getColor($index, group)}" class="red-line"></div></div><div class="data-container" ng-show="vm.expandField(group)"><div layout="column" ng-show="vm.expandField(group)" ng-if="vm.options.subFields"><div ng-repeat="el in vm.groupData[group]"><div ng-include="vm.options.extendedTemplate || \'lineChartSingleItemExpanded\'"></div></div></div></div></div><div layout="row" layout-align="end none" class="total">Total Count:{{vm.totalKeys}}</div></div></div><script type="text/ng-template" id="lineChartSingleItemExpanded"><div class="panel" layout="column" layout-align="center none">\n        <div layout="row" layout-align="space-between none" class="data-row">\n            <div ng-repeat="(field, displayText ) in vm.options.subFields">\n                <span class="bold-text">{{displayText}}</span>\n                <span>{{el[field]}}</span>\n            </div>\n        </div>\n    </div></script>')}])}()}(window,window.angular),window.cedrusUI={version:{full:"0.2.0"}};